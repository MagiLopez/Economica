{% extends "base.html" %}

{% block title %}Inter√©s Compuesto{% endblock %}

{% block content %}

<div class="container">
    <!-- Header -->
    <div class="header-small">
        <img src="{{ url_for('static', filename='logo.png') }}" alt="FINLY Logo" class="logo-small">
        <h1>üìä Inter√©s Compuesto</h1>
        <span class="user-info">{{ username }}</span>
    </div>

    <p class="instruction">
        Completa <strong>3 campos</strong> y deja <strong>1 vac√≠o</strong>. 
        FINLY calcular√° autom√°ticamente el faltante.
    </p>

    <form class="form" id="compoundForm">
        <div class="input-row">
            <div class="input-group">
                <label>Capital Inicial (P):</label>
                <input id="capital" type="number" step="0.01" placeholder="Ej. 1000">
                <small>Dinero inicial a invertir</small>
            </div>

            <div class="input-group">
                <label>Tasa de Inter√©s (%):</label>
                <input id="tasa" type="number" step="0.01" placeholder="Ej. 5">
                <small>Porcentaje por periodo</small>
            </div>
        </div>

        <div class="input-row">
            <div class="input-group">
                <label>Per√≠odo de la inversi√≥n:</label>
                <div class="time-input">
                    <input id="tiempo_meses" type="number" min="1" placeholder="N√∫mero de meses">
                    <input id="tiempo_pagos" type="number" min="1" placeholder="N√∫mero de pagos">
                </div>
                <small>Indica la duraci√≥n en meses y cu√°ntos pagos se hacen en total</small>
            </div>

            <div class="input-group">
                <label>Monto Final (M):</label>
                <input id="monto" type="number" step="0.01" placeholder="Ej. 1100">
                <small>Dinero total al final</small>
            </div>
        </div>

        <button type="submit" class="btn">üßÆ Calcular</button>
    </form>
    <div class="result-box hidden" id="resultBox">
        <div class="result-content">
            <h3>üí∞ Resultado:</h3>
            <div class="result-value" id="resultValue">0</div>
            <div class="result-detail" id="resultDetail"></div>
            <div class="result-detail" id="interestDetail"></div>
        </div>
    </div>

    <a href="/" class="btn-back">‚¨Ö Volver al Men√∫</a>
</div>

<script>
    const form = document.getElementById('compoundForm');
    const capitalInput = document.getElementById('capital');
    const tasaInput = document.getElementById('tasa');
    const tiempoMesesInput = document.getElementById('tiempo_meses');
    const tiempoPagosInput = document.getElementById('tiempo_pagos');
    const montoInput = document.getElementById('monto');
    const resultBox = document.getElementById('resultBox');
    const resultValue = document.getElementById('resultValue');
    const resultDetail = document.getElementById('resultDetail');
    const interestDetail = document.getElementById('interestDetail');

    form.addEventListener('submit', function (e) {
        e.preventDefault();

        // Considerar el tiempo como un solo campo (meses o pagos)
        const tiempoLleno = tiempoMesesInput.value || tiempoPagosInput.value;

        let filled = 0;
        if (capitalInput.value) filled++;
        if (tasaInput.value) filled++;
        if (tiempoLleno) filled++;
        if (montoInput.value) filled++;

        if (filled !== 3) {
            resultBox.classList.remove('hidden');
            resultValue.innerText = "‚ö† Validaci√≥n incorrecta";
            resultDetail.innerText = "Debes completar exactamente 3 campos y dejar 1 vac√≠o.";
            interestDetail.innerText = "";
            return;
        }

        resultBox.classList.remove('hidden');
        resultValue.innerText = "‚úî Validaci√≥n correcta";
        resultDetail.innerText = "C√°lculo listo para ejecutarse.";
        interestDetail.innerText = "Aqu√≠ aparecer√°n los resultados reales.";
    });
</script>

{% endblock %}
