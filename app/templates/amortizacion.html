{% extends "base.html" %}

{% block title %}Amortizaci√≥n{% endblock %}

{% block content %}
<div class="container">
    <div class="header-small">
        <img src="{{ url_for('static', filename='logo.png') }}" alt="FINLY Logo" class="logo-small">
        <h1>üìä Amortizaci√≥n</h1>
        <span class="user-info">{{ username }}</span>
    </div>

    <!-- Secci√≥n de Teor√≠a Colapsable -->
    <div class="teoria-section">
        <button class="teoria-toggle" type="button" id="teoriaBtn">
            <span id="teoriaIcon">‚ñ∂</span> Teor√≠a: ¬øQu√© es la Amortizaci√≥n?
        </button>
        <div class="teoria-content" id="teoriaContent">
            <h3>üí° Conceptos B√°sicos</h3>
            <p>La <strong>amortizaci√≥n</strong> es el proceso de pagar una deuda mediante pagos peri√≥dicos que cubren tanto el capital como los intereses.  
               Cada cuota se divide en dos partes: intereses sobre el saldo pendiente y abono a capital.</p>

            <h4>Tipos de Amortizaci√≥n:</h4>
            <div class="tipo-box">
                <strong>üîπ Amortizaci√≥n Francesa:</strong> Cuotas constantes durante todo el per√≠odo.<br>
                <strong>üîπ Amortizaci√≥n Alemana:</strong> Abono a capital constante, cuotas decrecientes.<br>
                <strong>üîπ Amortizaci√≥n Americana:</strong> Solo se pagan intereses, el capital al final.
            </div>

            <h4>F√≥rmulas Principales:</h4>
            <div class="formula-box">
                <strong>Cuota Fija (Sistema Franc√©s):</strong><br>
                Cuota = P √ó [i √ó (1 + i)‚Åø] / [(1 + i)‚Åø - 1]<br><br>

                <strong>Inter√©s del per√≠odo k:</strong><br>
                Inter√©s = Saldo √ó i<br><br>

                <strong>Abono a capital del per√≠odo k:</strong><br>
                Abono = Cuota - Inter√©s<br><br>

                <strong>Saldo despu√©s del per√≠odo k:</strong><br>
                Saldo = Saldo anterior - Abono a capital
            </div>

            <h4>Variables:</h4>
            <ul>
                <li><strong>P (Capital):</strong> Monto del pr√©stamo o deuda inicial</li>
                <li><strong>i (Tasa):</strong> Tasa de inter√©s por per√≠odo</li>
                <li><strong>n (Per√≠odos):</strong> N√∫mero total de pagos</li>
                <li><strong>Cuota:</strong> Pago peri√≥dico</li>
                <li><strong>Saldo:</strong> Capital pendiente por pagar</li>
            </ul>
        </div>
    </div>

    <p>Completa los campos requeridos para generar la tabla de amortizaci√≥n. El c√°lculo se realizar√° cuando est√© disponible la conexi√≥n.</p>

    <form id="amortizacionForm">
        <div class="input-row">
            <div class="input-group">
                <label for="capital">Capital (P):</label>
                <input type="number" id="capital" name="capital" step="0.01">
                <small>Monto del pr√©stamo</small>
            </div>

            <div class="input-group">
                <label for="tasa">Tasa de inter√©s (i):</label>
                <input type="number" id="tasa" name="tasa" step="0.01">
                <small>Por per√≠odo (%)</small>
            </div>
        </div>

        <div class="input-row">
            <div class="input-group">
                <label for="n">N√∫mero de per√≠odos (n):</label>
                <input type="number" id="n" name="n">
                <small>Cantidad de cuotas</small>
            </div>

            <div class="input-group full-width">
                <label for="tipoAmortizacion">Sistema de Amortizaci√≥n:</label>
                <select id="calcular" name="calcular">
                    <option value="frances">Sistema Franc√©s (Cuota Fija)</option>
                    <option value="aleman">Sistema Alem√°n (Abono Fijo)</option>
                    <option value="americano">Sistema Americano</option>
                </select>
            </div>
        </div>

        <button type="button" class="btn" id="calcularBtn">üìã Generar Tabla de Amortizaci√≥n</button>
    </form>

    <div class="result-box hidden" id="resultBox">
        <div class="result-content">
            <h3>üí∞ Resumen:</h3>
            <div class="result-value" id="resultValue">‚Äî</div>
            <div class="result-detail" id="resultDetail">El resultado aparecer√° aqu√≠.</div>
        </div>
    </div>

</div>



<script>
    // Mostrar/ocultar la teor√≠a
    document.getElementById('teoriaBtn').addEventListener('click', function() {
        const content = document.getElementById('teoriaContent');
        const icon = document.getElementById('teoriaIcon');
        content.classList.toggle('show');
        icon.classList.toggle('rotated');
    });

    // Bot√≥n de c√°lculo (sin conexi√≥n backend)
    document.getElementById('calcularBtn').addEventListener('click', function() {
        const resultBox = document.getElementById('resultBox');
        const resultValue = document.getElementById('resultValue');
        const resultDetail = document.getElementById('resultDetail');
        const tablaAmortizacion = document.getElementById('tablaAmortizacion');
        
        // Obtener valores del formulario
        const capital = parseFloat(document.getElementById('capital').value);
        const tasa = parseFloat(document.getElementById('tasa').value);
        const n = parseInt(document.getElementById('n').value);
        const tipoAmortizacion = document.getElementById('tipoAmortizacion').value;

        // Validar campos
        if (isNaN(capital) || isNaN(tasa) || isNaN(n)) {
            alert('Por favor, completa todos los campos correctamente');
            return;
        }

        // Mostrar mensaje temporal
        resultValue.textContent = "‚Äî";
        resultDetail.textContent = "La generaci√≥n de la tabla de amortizaci√≥n estar√° disponible pr√≥ximamente.";
        resultBox.classList.remove('hidden');
        
        // Ocultar tabla por ahora
        tablaAmortizacion.classList.add('hidden');
    });
</script>
{% endblock %}